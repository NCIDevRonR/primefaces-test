<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
      xmlns:jsf="http://xmlns.jcp.org/jsf"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">

    <h:head>
        <title>PrimeFaces Test</title>
        <h:outputScript library="js" name="test.js" />
        <h:outputStylesheet library="css" name="test.css" />
    </h:head>
    <h:body>

        <div class="card crud-demo">
            <h:form id="CityInfoListForm">
                <p:growl id="messages" showDetail="true" />

                <p:dataTable id="datalist" value="#{anotherCityController.items}" var="item" 
                             selectionMode="single" selection="#{anotherCityController.selectedItem}"
                             widgetVar="vdatalist"
                             paginator="true"
                             paginatorPosition="bottom"
                             rowKey="#{item.id}"
                             rows="10"
                             rowsPerPageTemplate="10,20,30,40,50"
                             sortMode="multiple"
                             >

                    <p:ajax event="rowSelect"   listener="#{anotherCityController.onRowSelect}" update="createButton editButton deleteButton"/>
                    <p:ajax event="rowUnselect" listener="#{anotherCityController.onRowUnselect}" update="createButton editButton deleteButton"/>

                    <p:column sortBy="#{item.zipCode}" filterBy="#{item.zipCode}" filterMatchMode="contains">
                        <f:facet name="header">
                            <h:outputText value="User Id"/>
                        </f:facet>
                        <h:outputText value="#{item.zipCode}"/>
                    </p:column>
                    <p:column sortBy="#{item.cityName}" filterBy="#{item.cityName}" filterMatchMode="contains">
                        <f:facet name="header">
                            <h:outputText value="Person"/>
                        </f:facet>
                        <h:outputText value="#{item.cityName}"/>
                    </p:column>
                    <p:column sortBy="#{item.stateName}" filterBy="#{item.stateName}" filterMatchMode="contains">
                        <f:facet name="header">
                            <h:outputText value="Description"/>
                        </f:facet>
                        <h:outputText value="#{item.stateName}"/>
                    </p:column>
                    <p:column sortBy="#{item.stateAbbrev}" filterBy="#{item.stateAbbrev}" filterMatchMode="contains">
                        <f:facet name="header">
                            <h:outputText value="Log Code"/>
                        </f:facet>
                        <h:outputText value="#{item.stateAbbrev}"/>
                    </p:column>


                    <f:facet name="footer">
                        <p:commandButton id="createButton" icon="ui-icon-plus"   value="Create" actionListener="#{anotherCityController.prepareCreate}" resetValues="true" update=":dialogs:CityInfoCreateDlg" oncomplete="PF('CityInfoCreateDialog').show()" rendered="true"/>                          
                        <p:commandButton id="editButton"   icon="ui-icon-pencil" value="Edit" actionListener="#{anotherCityController.prepareEdit}" resetValues="true" update=":dialogs:CityInfoEditDlg" oncomplete="PF('CityInfoEditDialog').show()" disabled="#{!anotherCityController.hasSelectedItem()}" rendered="true" 
                                         styleClass="edit-button ui-button-success" process="@this"/>
                        <p:commandButton id="deleteButton"  icon="ui-icon-trash"  value="Delete" actionListener="#{anotherCityController.prepareDelete}" oncomplete="PF('CityInfoDeleteDialog').show()" update=":dialogs:CityInfoDeleteDlg" disabled="#{!anotherCityController.hasSelectedItem()}" rendered="true" styleClass="ui-button-danger" />
                    </f:facet>
                </p:dataTable>




            </h:form>

            <h:form id="dialogs">

                <!-- Dialogs from SSDA User  -->
                <p:dialog id="CityInfoCreateDlg" widgetVar="CityInfoCreateDialog" modal="true" resizable="false" appendTo="@(body)" header="Create City">
				<h:form id="createCityForm">
                        <p:outputPanel id="create-city" class="ui-fluid">
                            <p:outputPanel rendered="#{not empty anotherCityController.selectedItem}">

                                <div class="field">
                                    <p:outputLabel value="Zip Code" for="zipCode" />
                                    <p:inputText id="zipCode" value="#{anotherCityController.selectedItem.zipCode}" title="Enter Zip Code." />
                                </div>
                                <div class="field">
                                    <p:outputLabel value="City Name" for="cityName" />
                                    <p:inputText id="cityName" value="#{anotherCityController.selectedItem.cityName}" title="Enter City Name." />
                                </div>
                                <div class="field">
                                    <p:outputLabel value="State Name" for="stateName" />
                                    <p:inputText id="stateName" value="#{anotherCityController.selectedItem.stateName}" title="Enter State Name." />
                                </div>
                                <div class="field">
                                    <p:outputLabel value="State Abbrev" for="stateAbbrev" />
                                    <p:inputText id="stateAbbrev" value="#{anotherCityController.selectedItem.stateAbbrev}" title="Enter State Abbrev." />
                                </div>
                                <div class="field">
                                    <p:outputLabel value="County" for="county" />
                                    <p:inputText id="county" value="#{anotherCityController.selectedItem.county}" title="Enter County." />
                                </div>

                            </p:outputPanel>
                        </p:outputPanel>

                        <p:panelGrid columns="2" styleClass="footer-buttons">
                            <p:commandButton actionListener="#{anotherCityController.create()}" value="Save" update="display,:CityInfoListForm:datalist" oncomplete="handleSubmit(args,'CityInfoCreateDialog');"/>
                            <p:commandButton actionListener="#{anotherCityController.clearSelectedRows()}" value="Cancel" styleClass="ui-button-secondary" immediate="true" onclick="closeDialog('CityInfoCreateDialog');"/>
                        </p:panelGrid>
                </h:form>
				</p:dialog>

                <p:dialog id="CityInfoEditDlg" widgetVar="CityInfoEditDialog" modal="true" resizable="false" appendTo="@(body)" header="Edit City">
				<h:form id="editCityForm">
                        <p:outputPanel id="edit-city" class="ui-fluid">
                            <p:outputPanel rendered="#{not empty anotherCityController.selectedItem}">

                                <div class="field">
                                    <p:outputLabel value="Zip Code" for="zipCode" />
                                    <p:inputText id="zipCode" value="#{anotherCityController.selectedItem.zipCode}" title="Enter Zip Code." />
                                </div>
                                <div class="field">
                                    <p:outputLabel value="City Name" for="cityName" />
                                    <p:inputText id="cityName" value="#{anotherCityController.selectedItem.cityName}" title="Enter City Name." />
                                </div>
                                <div class="field">
                                    <p:outputLabel value="State Name" for="stateName" />
                                    <p:inputText id="stateName" value="#{anotherCityController.selectedItem.stateName}" title="Enter State Name." />
                                </div>
                                <div class="field">
                                    <p:outputLabel value="State Abbrev" for="stateAbbrev" />
                                    <p:inputText id="stateAbbrev" value="#{anotherCityController.selectedItem.stateAbbrev}" title="Enter State Abbrev." />
                                </div>
                                <div class="field">
                                    <p:outputLabel value="County" for="county" />
                                    <p:inputText id="county" value="#{anotherCityController.selectedItem.county}" title="Enter County." />
                                </div>

                            </p:outputPanel>
                        </p:outputPanel>

                        <p:panelGrid columns="2" styleClass="footer-buttons">
                            <p:commandButton value="Save" 
                                             action="#{anotherCityController.saveEdit}" 
                                             update=":CityInfoListForm:datalist" 
                                             oncomplete="highlightRow()" />
                            <p:commandButton value="Cancel" styleClass="ui-button-secondary" action="#{anotherCityController.cancelEdit}" oncomplete="PF('CityInfoEditDialog').hide();" update=":CityInfoListForm:datalist" />

                        </p:panelGrid>



                        <p:remoteCommand name="highlightRow" 
                                         onstart="console.log('Selected Item ID: #{anotherCityController.selectedItem.id}'); 
                                         PF('CityInfoEditDialog').hide();
                                         var table = PF('vdatalist').jq; 
                                         var selectedRow = table.find('tr[data-rk=#{anotherCityController.selectedItem.id}]'); 
                                         selectedRow.addClass('ui-state-highlight');" />            
                </h:form>
				</p:dialog>

                <p:confirmDialog id="CityInfoDeleteDlg" widgetVar="CityInfoDeleteDialog" appendTo="@(body)" header="Delete City">
				<h:form id="deleteCityForm">
                       <p:outputPanel id="delete-city" class="ui-fluid">
                            <p:outputPanel rendered="#{not empty anotherCityController.selectedItem}">

                                <div class="field">
                                    <p:outputLabel value="Zip Code: " for="zipCode" />
                                    <h:outputText id="zipCode" value="#{anotherCityController.selectedItem.zipCode}" title="Enter Zip Code." />
                                </div>
                                <div class="field">
                                    <p:outputLabel value="City Name: " for="cityName" />
                                    <h:outputText id="cityName" value="#{anotherCityController.selectedItem.cityName}" title="Enter City Name." />
                                </div>
                                <div class="field">
                                    <p:outputLabel value="State Name: " for="stateName" />
                                    <h:outputText id="stateName" value="#{anotherCityController.selectedItem.stateName}" title="Enter State Name." />
                                </div>
                                <div class="field">
                                    <p:outputLabel value="State Abbrev: " for="stateAbbrev" />
                                    <h:outputText id="stateAbbrev" value="#{anotherCityController.selectedItem.stateAbbrev}" title="Enter State Abbrev." />
                                </div>
                                <div class="field">
                                    <p:outputLabel value="County: " for="county" />
                                    <h:outputText id="county" value="#{anotherCityController.selectedItem.county}" title="Enter County." />
                                </div>

                            </p:outputPanel>
                        </p:outputPanel>

                        <p:panelGrid columns="2" styleClass="footer-buttons">
                            <p:commandButton value="Delete" 
                                             icon="pi pi-check" 
											 action="#{anotherCityController.destroy}" 
                                             process="@this"
											 update="@obs(selection-changed)"
                                             oncomplete="PF('CityInfoDeleteDialog').hide();" />
                            <p:commandButton value="Cancel" styleClass="ui-button-secondary" action="#{anotherCityController.cancelEdit}" oncomplete="PF('CityInfoDeleteDialog').hide();" update=":CityInfoListForm:datalist" />
                        </p:panelGrid>

                </h:form>
				</p:confirmDialog>

                <p:confirmDialog global="true" showEffect="fade" width="300">
                    <p:commandButton value="Yes" type="button" styleClass="ui-confirmdialog-yes" icon="pi pi-check" />
                    <p:commandButton value="No" type="button" styleClass="ui-confirmdialog-no ui-button-secondary"
                                     icon="pi pi-times" />
                </p:confirmDialog>



            </h:form>

        </div>

    </h:body>

</html>
